<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Boggle</title>
  <style>
    body {
      background: #222;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .boggle-table {
      border-collapse: separate;
      border-spacing: 4px;
      background: rgb(230, 79, 48);
      margin: 20px 0;
    }

    .boggle-td {
      width: 50px;
      height: 50px;
      text-align: center;
      vertical-align: middle;
      font-size: 1.5rem;
      font-weight: bold;
      color: #fff;
      background: rgb(230, 79, 48);
      border: 2px solid #000;
      user-select: none;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .boggle-td.selected {
      background: #fff;
      color: rgb(230, 79, 48);
    }
  </style>
</head>

<body>
  <h1>Boggle 8x8</h1>
  <div id="boggleBoard"></div>
  <div id="currentWord" style="font-size:1.2rem; margin-bottom:10px;"></div>
  <div id="foundWords" style="font-size:1rem;"></div>
  <script>
    const boardSize = 8;
    const board = Array.from({ length: boardSize }, () => Array(boardSize).fill(''));
    let selectedTiles = [];
    let foundWords = [];
    let dictionary = [];
    let isDragging = false;

    // Função para carregar o dicionário
    fetch('mydictionary.txt')
      .then(response => response.text())
      .then(text => {
        dictionary = text.split(/\r?\n/).map(w => w.trim().toUpperCase()).filter(w => w.length > 0);
        fillBoardWithWords();
        renderBoard();
      });

    // Preenche o tabuleiro com palavras do dicionário em todas as direções
    function fillBoardWithWords() {
      // Limpa o tabuleiro
      for (let i = 0; i < boardSize; i++)
        for (let j = 0; j < boardSize; j++)
          board[i][j] = '';

      // Direções: [dx, dy]
      const directions = [
        [0, 1],   // direita
        [1, 0],   // baixo
        [1, 1],   // diagonal baixo-direita
        [-1, 1],  // diagonal cima-direita
        [0, -1],  // esquerda
        [-1, 0],  // cima
        [-1, -1], // diagonal cima-esquerda
        [1, -1],  // diagonal baixo-esquerda
      ];

      // Tenta inserir palavras do dicionário
      for (const word of dictionary) {
        let placed = false;
        for (let attempt = 0; attempt < 100 && !placed; attempt++) {
          const dir = directions[Math.floor(Math.random() * directions.length)];
          const reverse = Math.random() < 0.5;
          const w = reverse ? word.split('').reverse().join('') : word;
          const len = w.length;
          const startRow = Math.floor(Math.random() * boardSize);
          const startCol = Math.floor(Math.random() * boardSize);

          let r = startRow, c = startCol;
          let fits = true;
          for (let k = 0; k < len; k++) {
            if (
              r < 0 || r >= boardSize ||
              c < 0 || c >= boardSize ||
              (board[r][c] !== '' && board[r][c] !== w[k])
            ) {
              fits = false;
              break;
            }
            r += dir[0];
            c += dir[1];
          }
          if (fits) {
            r = startRow; c = startCol;
            for (let k = 0; k < len; k++) {
              board[r][c] = w[k];
              r += dir[0];
              c += dir[1];
            }
            placed = true;
          }
        }
      }
      // Preenche espaços vazios com letras aleatórias
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      for (let i = 0; i < boardSize; i++)
        for (let j = 0; j < boardSize; j++)
          if (board[i][j] === '')
            board[i][j] = letters[Math.floor(Math.random() * letters.length)];
    }

    // Renderiza o tabuleiro
    function renderBoard() {
      const boardDiv = document.getElementById('boggleBoard');
      let table = document.createElement('table');
      table.className = 'boggle-table';
      for (let i = 0; i < boardSize; i++) {
        let tr = document.createElement('tr');
        for (let j = 0; j < boardSize; j++) {
          let td = document.createElement('td');
          td.className = 'boggle-td';
          td.textContent = board[i][j];
          td.dataset.row = i;
          td.dataset.col = j;
          if (selectedTiles.some(t => t.row === i && t.col === j)) {
            td.classList.add('selected');
          }
          tr.appendChild(td);
        }
        table.appendChild(tr);
      }
      boardDiv.innerHTML = '';
      boardDiv.appendChild(table);
    }

    // Eventos de mouse para seleção
    document.getElementById('boggleBoard').addEventListener('mousedown', e => {
      if (e.target.classList.contains('boggle-td')) {
        isDragging = true;
        selectedTiles = [];
        selectTile(e.target);
        renderBoard();
        updateCurrentWord();
      }
    });
    document.getElementById('boggleBoard').addEventListener('mouseover', e => {
      if (isDragging && e.target.classList.contains('boggle-td')) {
        selectTile(e.target);
        renderBoard();
        updateCurrentWord();
      }
    });
    document.addEventListener('mouseup', () => {
      if (isDragging) {
        isDragging = false;
        renderBoard();
        checkWord();
        updateCurrentWord();
      }
    });

    function selectTile(tile) {
      const row = parseInt(tile.dataset.row);
      const col = parseInt(tile.dataset.col);
      if (!selectedTiles.some(t => t.row === row && t.col === col)) {
        selectedTiles.push({ row, col, letter: board[row][col] });
      }
    }

    function updateCurrentWord() {
      const word = selectedTiles.map(t => t.letter).join('');
      document.getElementById('currentWord').textContent = word;
    }

    function checkWord() {
      const word = selectedTiles.map(t => t.letter).join('');
      if (word.length > 2 && dictionary.includes(word) && !foundWords.includes(word)) {
        foundWords.push(word);
        document.getElementById('foundWords').textContent = foundWords.join(', ');
      }
      selectedTiles = [];
    }
  </script>
</body>

</html>